### Требования к проекту **Scheduler**

#### Авторизация пользователей

Должна быть авторизация через [Вконтакте](vk.com)

### Роли пользователей

* #### Студенты

  * Староста (выдаётся при создании группы, можно передать)
  * Модератор
  * Редактор
  * Рядовой студент

* #### Учителя

  * Рядовой учитель (энивей у них нет возможностей :D)

* #### Гости

  * Все неавторизованные пользователи и авторизованные пользователи без назначенной роли

### Возможности ролей 

#### Учитель:

* Не имеет возможностей, т. к. невозможно войти под этим типом пользователя

#### Гость:

* Просматривать информацию с публичным доступом:
  * Группы
  * Занятия
  * Задания
  * Экзамены

#### Зарегистрированный пользователь:

* *Возможности гостя*
* Право создавать приватные группы (неограниченное число)
* Право вступать в группы (неограниченное число)
* Право просматривать приватную информацию, принадлежащую пользователю



***Все возможности ролей ниже относятся именно к группе в которой имеется данная роль***



#### Рядовой студент:

* *Возможности зарегистрированного пользователя*
* Право просматривать информацию группы с групповым доступом
* Право добавлять заметки к заданию
* Право добавлять заметки к экзамену
* Право покидать группу
* Право загрузить файл расписания для добавления его в расписание

#### Редактор:

* *Возможности рядового студента*
* Право создавать занятие
* Право редактировать занятие
* Право удалять занятие
* Право создать задание по занятию
* Право редактировать задание
* Право добавить экзамен
* Право редактировать экзамен

#### Модератор:

* *Возможности редактора*
* Право приглашать в группу (создавать ссылку для вступления)
* Право назначить роль редактора
* Право делать группу публичной
* Право удалять задание
* Право удалять экзамен
* Право исключать участника из группы, рангом ниже модератора

#### Староста:

* *Возможности модератора*
* Право назначить роль модератора
* Право исключать из группы модераторов
* Право передать роль старосты
* Право удалить группу

### Сущности предметной области

##### Пользователь

* Имя*
* Фамилия*
* Отчество
* Телефон
* Почтовый ящик

##### Группа

* Участники группы*
* Занятия в группе
* Задания группы
* Экзамены группы

##### Занятие

* Группа*

* Преподаватель
* Урок*
* Аудитория
* Время*
* Чётность недели*

##### Задание

* Группа*
* Урок*
* Дата выдачи*
* Занятие, на котором выдали*
* Дата сдачи*
* Занятие, на котором сдавать

##### Урок

* Название*
* Кафедра

##### Аудитория

* Название*

##### Экзамен

* Группа*

* Дата экзамена*
* Время экзамена*
* Преподаватель*

#### Доступность контента

Контент может быть 3 типов:

* Public (для всех)
* Group (для участников группы)
* Inherited (для пользователя)

*Не все сущности могут иметь любой тип доступа*

##### Возможные модификаторы доступа для сущностей:

* Пользователь

  * Public

  *По умолчанию **Public***

* Группа

  * Public
  * Group

  *По умолчанию **Group***

* Занятие
  * Inherited

  * Group

  
*По умолчанию **Inherited***
  
* Задание
  * Inherited
* Group
  
*По умолчанию **Inherited***
  
* Урок

  * Public
  * Group
  
*По умолчанию **Public***
  
* Аудитория
  * Public
  * Group
  
*По умолчанию **Public***
  
* Экзамен
  * Inherited
* Group
  
*По умолчанию **Inherited***

### Сценарии использования

1. **Возможный пользователь впервые зашёл на сайт**
   1. *Проверяются права пользователя*
   2. Пользователь не авторизован
   3. Пользователь считается гостем и обладает его возможностями

2. **Возможный пользователь выполняет первую авторизацию**

   1. Пользователь начинает авторизацию через стороннего провайдера

   2. Сайт перенаправляет его на стороннего провайдера

   3. Пользователь вводит свои данные и авторизуется у стороннего провайдера

   4. Пользователя возвращает на страницу профиля

   5. Пользователь заполняет информацию:

      1. Имя*

      2. Фамилия*

      3. Отчество
      4. Телефон
      5. e-mail

   6. Провайдер авторизации сохраняется вместе с введёнными данными

   7. Пользователь считается зарегистрированным пользователем

   *Расширения:*

   3a. Пользователь не авторизовывается у стороннего провайдера

   4. Регистрация пользователя считается проваленной

   

   5а. Пользователь не вводит необходимую информацию

   6. Сервис не даёт продолжить регистрацию, пока не будут введены требуемые данные

3. **Зарегистрированный пользователь создаёт группу**

   1. *Проверяются права пользователя*
   2. Пользователь зарегистрирован и авторизован
   3. Появляется кнопка создания группы
   4. Пользователь нажимает кнопку создания группы
   5. Сервис предлагает ввести данные группы:
      1. Название*
      2. Описание
      3. Является ли эта группа официальной группой университета*
   6. Пользователь вводит необходимые данные
   7. Проверяется возможность создания группы:
      1. Название уникальное
   8. Группа прошла проверки и её возможно создать
   9. Создаётся группа
   10. Пользователь назначается старостой группы

   Расширения:

   2а. Пользователь не зарегистрирован

   1. Кнопка создания группы не появляется и создание группы **недоступно даже через прямой вызов API**

   6а. Пользователь не вводит необходимые данные

   1. Сервис не позволяет создать группу, пока данные не будут введены

   8а. Группа не прошла проверки и её создание невозможно

   1. Сервис уведомляет пользователя и необходимости изменить данные для продолжения

4. **Зарегистрированный пользователь входит в группу**

   1. Пользователь извне получает приглашение в группу в виде ссылки
   2. Пользователь переходит по ссылке
   3. *Проверяются права пользователя*
   4. Пользователь зарегистрирован и авторизован
   
5. **Пользователь просматривает информацию другого пользователя**
  
  1. Пользователь попадает на профиль зарегистрированного пользователя
  2. *Проверяются права пользователя*
  3. Отображаются данные зарегистрированного пользователя
  
  Расширения:
  
  3а. Пользователь не зарегистрирован
  
  1. Данные просматриваемого профиля не отображаются, вместо этого отображается информация, что незарегистрированный пользователь не может просматривать информацию зарегистрированных пользователей.
  
6. **Пользователь покидает группу**

  1. Пользователь покидает группу.
  2. В независимости от его роли в группе, его текущей ролью становится *рядовой студент*
  
  Расширения
  
  1а. Пользователь был выкинут из группы другим пользователем группы с рангом выше, чем этот пользователь.
  2. В независимости от его роли в группе, его текущей ролью становится *рядовой студент*
  
7. **Модератор или староста меняют приватность группы**

  1. Пользователь с ролью *модератор* или *староста* меняет уровень доступа группы на ***public**
  2. Следующие сущности группы меняют свой уровень доступа на ***public**: группа, урок, аудитория.
  
  Расширения:
  
  1а. Пользователь с ролью *модератор* или *староста* меняет уровень доступа группы на *group*
  1.  Следующие сущности группы меняют свой уровень доступа на *group*: группа, урок, аудитория.
  
8. **Староста передаёт роль**

  1. Выбранный *старостой* пользователь получает роль *старосты*
  2. Выбиравший пользователя меняет свою роль на *рядовой студент*
  
9. **Удаление группы**

  1. Староста воспроизводит удаление группы.
  2. Все сущности связанные с группой (за исключением сущности *пользователь*) более недоступны.
  3. Все участники группы получают роль *рядовой студент*
