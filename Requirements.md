### Требования к проекту **Scheduler**

#### Авторизация пользователей

Должна быть авторизация через [Вконтакте](vk.com)

### Роли пользователей

* #### Студенты

  * Староста (выдаётся при создании группы, можно передать)
  * Модератор
  * Редактор
  * Рядовой студент

* #### Учителя

  * Рядовой учитель (энивей у них нет возможностей :D)

* #### Гости

  * Все неавторизованные пользователи и авторизованные пользователи без назначенной роли

### Возможности ролей 

#### Учитель:

* Не имеет возможностей, т. к. невозможно войти под этим типом пользователя

#### Гость:

* Просматривать информацию с публичным доступом:
  * Группы
  * Занятия
  * Задания
  * Экзамены

#### Зарегистрированный пользователь:

* *Возможности гостя*
* Право создавать приватные группы (неограниченное число)
* Право вступать в группы (неограниченное число)
* Право просматривать приватную информацию, принадлежащую пользователю



***Все возможности ролей ниже относятся именно к группе в которой имеется данная роль***



#### Рядовой студент:

* *Возможности зарегистрированного пользователя*
* Право просматривать информацию группы с групповым доступом
* Право добавлять заметки к заданию
* Право добавлять заметки к экзамену
* Право покидать группу
* Право загрузить файл расписания для добавления его в расписание

#### Редактор:

* *Возможности рядового студента*
* Право создавать занятие
* Право редактировать занятие
* Право удалять занятие
* Право создать задание по занятию
* Право редактировать задание
* Право добавить экзамен
* Право редактировать экзамен

#### Модератор:

* *Возможности редактора*
* Право приглашать в группу (создавать ссылку для вступления)
* Право назначить роль редактора
* Право делать группу публичной
* Право удалять задание
* Право удалять экзамен
* Право исключать участника из группы, рангом ниже модератора

#### Староста:

* *Возможности модератора*
* Право назначить роль модератора
* Право исключать из группы модераторов
* Право передать роль старосты
* Право удалить группу

### Сущности предметной области

##### Пользователь

* Имя*
* Фамилия*
* Отчество
* Телефон
* Почтовый ящик

##### Группа

* Участники группы*
* Занятия в группе
* Задания группы
* Экзамены группы

##### Занятие

* Группа*

* Преподаватель
* Урок*
* Аудитория
* Время*
* Чётность недели*

##### Задание

* Группа*
* Урок*
* Дата выдачи*
* Занятие, на котором выдали*
* Дата сдачи*
* Занятие, на котором сдавать

##### Урок

* Название*
* Кафедра

**Тип урока**

* Название*
* Описание

##### Аудитория

* Название*

##### Экзамен

* Группа*

* Дата экзамена*
* Время экзамена*
* Преподаватель*

#### Доступность контента

Контент может быть 3 типов:

* Public (для всех)
* Group (для участников группы)
* Inherited (наследуется)

*Не все сущности могут иметь любой тип доступа*

##### Возможные модификаторы доступа для сущностей:

* Пользователь

  * Public

  *По умолчанию **Public***

* Группа

  * Public
  * Group

  *По умолчанию **Group***

* Занятие
  * Inherited

  * Group

  *По умолчанию **Inherited***
  
* Задание

  * Inherited
  * Group

  *По умолчанию **Inherited***

* Урок

  * Public

  *По умолчанию **Public***

* Аудитория
  * Public

  *По умолчанию **Public***

* Экзамен

  * Inherited
  * Group

  *По умолчанию **Inherited***

### Сценарии использования

1. **Возможный пользователь впервые зашёл на сайт**
   1. *Проверяются права пользователя*
   2. Пользователь не авторизован
   3. Пользователь считается гостем и обладает его возможностями

2. **Возможный пользователь выполняет первую авторизацию**

   1. Пользователь начинает авторизацию через стороннего провайдера

   2. Сайт перенаправляет его на стороннего провайдера

   3. Пользователь вводит свои данные и авторизуется у стороннего провайдера

   4. Пользователя возвращает на страницу профиля

   5. Пользователь заполняет информацию:

      1. Имя*

      2. Фамилия*

      3. Отчество
      4. Телефон
      5. e-mail

   6. Провайдер авторизации сохраняется вместе с введёнными данными

   7. Пользователь считается зарегистрированным пользователем

   *Расширения:*

   3a. Пользователь не авторизовывается у стороннего провайдера

   4. Регистрация пользователя считается проваленной

   

   5а. Пользователь не вводит необходимую информацию

   6. Сервис не даёт продолжить регистрацию, пока не будут введены требуемые данные

3. **Зарегистрированный пользователь создаёт группу**

   1. *Проверяются права пользователя*
   2. Пользователь зарегистрирован и авторизован
   3. Появляется кнопка создания группы
   4. Пользователь нажимает кнопку создания группы
   5. Сервис предлагает ввести данные группы:
      1. Название*
      2. Описание
      3. Является ли эта группа официальной группой университета*
   6. Пользователь вводит необходимые данные
   7. Проверяется возможность создания группы:
      1. Название уникальное
   8. Группа прошла проверки и её возможно создать
   9. Создаётся группа
   10. Пользователь назначается старостой группы

   Расширения:

   2а. Пользователь не зарегистрирован

   1. Кнопка создания группы не появляется и создание группы **недоступно даже через прямой вызов API**

   6а. Пользователь не вводит необходимые данные

   1. Сервис не позволяет создать группу, пока данные не будут введены

   8а. Группа не прошла проверки и её создание невозможно

   1. Сервис уведомляет пользователя и необходимости изменить данные для продолжения

4. **Зарегистрированный пользователь входит в группу**

   1. Пользователь извне получает приглашение в группу в виде ссылки   
   2. Пользователь переходит по ссылке
   3. *Проверяются права пользователя*
   4. Пользователь зарегистрирован и авторизован
   5. Пользователь регистрируется в этой группе (заносится в список участников группы)
   6. Роль пользователя меняется на *рядовой студент* относительно этой группы
   
   Расширение:
   
   2a. Страница по данной ссылке более не существует
   
   1. Пользователь перенаправлен на страницу, сообщающей пользователю, что такой группы более не существует
   
   2б. Пользователь уже зарегистрирован в данной группе
   
   1. Пользователь перенаправлен на страницу группы
   
5. **Пользователь просматривает информацию другого пользователя**
  
   1. Пользователь переходит по ссылке на профиль другого пользователя
     или
     пользователь оказывается на профиле другого пользователя по ссылке
   2. *Проверяются права пользователя*
   3. На странице просматриваемого пользователя отображаются личные данные этого пользователя:
      1. Имя
      2. Фамилия
      3. Отчество
      4. Телефон
      5. Почтовый ящик
     
   Расширения:

   1а. Страницы просматриваемого пользователя не существует

     1. Пользователь перенаправлен на другую страницу  
     2. Страница содержит сообщение, что просматриваемый пользователь не существует

   2а. Пользователь не зарегистрирован

     1. Пользователь перенаправлен на другую страницу  
     2. Страница содержит сообщение, что незарегистрированные в системе пользователи (пользователи с ролью *гость*) не могут просматривать личные данные зарегистрированных пользователей (пользователи с ролью *зарегистрированный пользователь*)
  
6. **Пользователь покидает группу**

   1. Пользователь находится на странице группы, в которой он зарегистрирован  
   2. Пользователь нажимает на кнопку покинуть группу  
   3. Пользователь удаляется из списка участников группы  
   4. Пользователь получает роль *зарегистрированного пользователя* относиельно этой группы
   
   Расширения:

   2а. Другой пользователь исключает пользователя из группы
  
   1. Другой пользователь на странице группы нажимает кнопку "исключить участника"  
   2. Появляется список участников этой группы
     
     1. Другой пользователь имеет роль *модератора*
         
         1. Появившийся список содержит участников группы со следующими ролями: *рядовой студент*, *редактор*        
         2. Другой пользователь выбирает участника из списка         
         3. Выбранный участник удаляется из списка участников группы         
         4. Выбранный участник получает роль *зарегистрированного пользователя* относительно этой группы
         
      2. Другой пользователь имеет роль *старосты*
      
         1. Появившийся список содержит участников группы со следующими ролями: *рядовой студент*, *редактор*, *модератор*         
         2. Другой пользователь выбирает участника из списка         
         3. Выбранный участник удаляется из списка участников группы         
         4. Выбранный участник получает роль *зарегистрированного пользователя* относительно этой группы
  
7. **Изменение уровня доступа группы**

   1. Пользователь обладает ролью *модератора* или *старосты*   
   2. Пользователь нажимает кнопку "Изменить доступ к группе" на странице группы   
   3. Появляется список с вариантами уровней видимости к группе: ***public**, ***group**   
   4. Пользователь выбирает один из вариантов   
   5. Следующие сущности группы меняют свой уровень видимости: //я запуталсо с уровнями видимости
   
   Расширение:
   
   4а. Пользователь выбрал ***public**
      
      1. Следующие сущности группы меняют свой уровень видимости на ***public**: //запуталсо[2]
   
   4б. Пользователь выбрал ***group**
   
      1. Следующие сущности меняют свой уровень видимости на ***group**: //запуталсо[3]
  
8. **Староста передаёт роль**

   1. Пользователь с ролью *староста* на странице группы нажимает на кнопку передать роль *старосты*  
   2. Появляется полный список участников группы  
   3. Пользователь выбирает участника группы из списка  
   4. Роль пользователя сменяется на *рядовой студент* относительно этой группы  
   5. Роль выбранного участника группы сменяется на *староста* относительно этой группы
  
9. **Удаление группы**

   1. Пользователь с ролью *староста* на странице группы нажимает на кнопку *удалить группу*  
   2. Следующие сущности группы более недоступны (удалены): участники группы, занятия группы, задания группы, экзамены группы   
   3. Все участники группы получают роль *зарегистрированного пользователя* относительно этой группы   
   4. Ссылки на страницу данной группы перенаправляют на страницу с информацией, что данной группы не существует

10. **Пользователь попадает на страницу группы (не по приглашению)**

   1. Пользователь попадает на страницу группы  
   2. Пользователю предоставлена информация относительно сущностей: группа, урок, аудитория

   Расширение:

   1а. Пользователь попадает на страницу группы, с уровень доступа ***Group**

    1. Пользователь перенаправлен на страницу, сообщающей пользователю, что доступ к данным этой группы ограничен

   1б. Группы не существует

    1. Пользователь перенаправлен на страницу, сообщающей пользователю, что такой группы более не существует

11. **Добавление заметок к заданиям, экзаменам**

   1. Страницу группы посещает пользователь, принадлежащий к одной из следующих ролей: *рядовой студент*, *редактор*, *модератор*, *староста*
   2. Пользователь выбирает категорию данных: экзамены группы, задания группы
   3. Пользователь переходит на страницу выбранной категории данных
   4. Пользователь выбирает единицу данных, для которой нужно добавить заметку
   5. (допустим) Перед пользователем появляется небольшое текстовое окно, которое можно заполнить любым текстом
   6. Пользователь вводит данные в текстовое окно
   7. Пользователь нажимает на кнопку "Сохранить изменения" на странице категории
   8. Относительно выбранной единицы данных, сохраняется текстовая информация
   
   Расширение:
   
   7а. Пользователь исключён из группы или группа удалена во время добавления заметки
      1. Вносимые изменения не сохраняются
      2. Пользователь перенаправляется на страницу с сообщением, что доступ к изменениям в данной группе был потерян
      
12. **Добавление, редактирование и удаления занятий, экзаменов, заданий**

   1. Страницу группы посещает пользователь с одной из следующих ролей относительно этой группы: *редактор*, *модератор*, *староста*
   2. Пользователь переходит на страницу выбранной категории данных: задания по группе, занятия по группе, экзамены по группе
   3. Пользователь выбирает род изменений в данной категории: добавление, редактирование, удаление
   4. Пользователь совершает изменения в категории
   5. Пользователь нажимает на кнопку "Сохранить изменения" на странице категории
   
   Расширение:
   
   2а. Пользователь переходит в категорию "Занятия по группе"
   
      1. Пользователь решает какого рода изменения совершить: добавление, редактирование, удаление
      
         1. Пользователь нажимает кнопку "Добавить"
         
            1. Появляется текстовое окно, в которое можно внести данные и делать их изменение
            
         2. Пользователь выбирает единицу данных и нажимает кнопку "Редактирование"
         
            1. Появляется текстовое окно, в которое можно внести данные и делать их изменение
            
         3. Пользователь выбирает единицу данных и нажимает кнопку "Удалить"
         
            1. Единица данных удаляется из категории
            
   2б. Пользователь переходит в категорию "Экзамены по группе" или "Задания по группе" с ролью *редактор*
      
      1. Пользователь решает какого рода изменения совершить: добавление, редактирование
      
         1. Пользователь нажимает кнопку "Добавить"
         
            1. Появляется текстовое окно, в которое можно внести данные и делать их изменение
            
         2. Пользователь выбирает единицу данных и нажимает кнопку "Редактирование"
         
            1. Появляется текстовое окно, в которое можно внести данные и делать их изменение
            
   3б. Пользователь переходит в категорию "Экзамены по группе" или "Задания по группе" с ролью *модератор* или *староста*
   
      1. Пользователь решает какого рода изменения совершить: добавление, редактирование, удаление
      
         1. Пользователь нажимает кнопку "Добавить"
         
            1. Появляется текстовое окно, в которое можно внести данные и делать их изменение
            
         2. Пользователь выбирает единицу данных и нажимает кнопку "Редактирование"
         
            1. Появляется текстовое окно, в которое можно внести данные и делать их изменение
            
         3. Пользователь выбирает единицу данных и нажимает кнопку "Удалить"
         
            1. Единица данных удаляется из категории
   
   5а. Пользователь исключён из группы или группа удалена во время добавления заметки
      1. Вносимые изменения не сохраняются
      2. Пользователь перенаправляется на страницу с сообщением, что доступ к изменениям в данной группе был потерян
      
13. **Загрузка файла расписания**

   1. Страницу группы посещает пользователь, принадлежащий к одной из следующих ролей: *рядовой студент*, *редактор*, *модератор*, *староста*
   2. Пользователь нажимает кнопку "Добавить расписание"
   3. Появляется окошко, в котором нужно выбрать загружаемый файл
   4. Происходит загрузка файла
   5. После загрузки происходит автоматическое сохранение изменений
   
   Расширение:
   
   4а. Выбран неверный формат файла
   
      1. Загрузка прерывается.
      2. Появляется сообщение, о неподходящем формате файла
      
   4б. Пользователь исключён из группы или группа удалена во время добавления заметки
   
      1. Вносимые изменения не сохраняются
      2. Пользователь перенаправляется на страницу с сообщением, что доступ к изменениям в данной группе был потерян
